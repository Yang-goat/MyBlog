---
icon: pen-to-square
date: 2025-12-04
# order: 1
category:
  - 数学
tag:
  - 随笔
  - 假设检验
  - 参数检验
---

# p 值（p-value）

## 1. p 值的核心概念

p 值用于衡量 **在原假设 $H_0$ 为真时，观察到当前样本数据（或更极端）出现的概率**。

定义：

- $p$ 值小 → 数据在 $H_0$ 下不常见 → 倾向拒绝 $H_0$
- $p$ 值大 → 数据与 $H_0$ 一致 → 不拒绝 $H_0$

数学表达式（双侧）：

$$
p = P(|T| \ge |t_{\text{obs}}| \mid H_0)
$$

---

## 2. p 值不是什么

- p 值 **不是**“原假设为真的概率”
- p 值 **不是**“差异显著的概率”
- p 值 **不能**“衡量效果大小”
- p 值 **不代表**实际意义，只说明统计意义

---

## 3. p 值与分布的关系

p 值来自**统计量的抽样分布**，而不是固定使用正态分布。

不同检验对应不同分布：

- z 检验 → 标准正态分布 $N(0,1)$
- t 检验 → t 分布
- $\chi^2$ 检验 → 卡方分布
- F 检验 → F 分布
- 非参数检验 → 各自的抽样分布
- 自助法（bootstrap）、置换检验（permutation） → 经验分布

因此：

> **p 值不是基于正态分布整体，而是基于“统计量在 $H_0$ 下的分布”。**

---

## 4. p 值计算流程（通用）

1. **构建统计量**  
   如：$z$、$t$、$\chi^2$、$F$。

2. **确定该统计量在 $H_0$ 下的理论分布**

3. **计算观察值对应的尾部概率**：

$$
p = P(\text{统计量 \geq 观察值} \mid H_0)
$$

（根据单侧 / 双侧决定是否乘 2）

---

## 5. 常见检验及 p 值计算公式

### 5.1 单样本 t 检验

统计量：

$$
t = \frac{\bar{x} - \mu_0}{s / \sqrt{n}}
$$

p 值（双侧）：

$$
p = 2 \times P(T \ge |t|;\ df=n-1)
$$

---

### 5.2 双样本 t 检验（等方差）

$$
t = \frac{\bar{x}_1 - \bar{x}_2}{s_p\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}}
$$

其中 pooled variance:

$$
s_p^2 = \frac{(n_1 - 1)s_1^2 + (n_2 - 1)s_2^2}{n_1 + n_2 - 2}
$$

---

### 5.3 z 检验（已知方差或大样本）

$$
z = \frac{\bar{x} - \mu_0}{\sigma / \sqrt{n}}
$$

p 值：

$$
p = 2(1 - \Phi(|z|))
$$

---

### 5.4 卡方检验（分类表）

统计量：

$$
\chi^2 = \sum \frac{(O - E)^2}{E}
$$

p 值：

$$
p = P(\chi^2_{\text{df}} \ge \chi^2_{\text{obs}})
$$

---

### 5.5 F 检验（方差分析、回归整体显著性）

$$
p = P(F_{\text{df}_1,\text{df}_2} \ge F_{\text{obs}})
$$

---

## 6. 回归中的 p 值

回归系数 $\hat{\beta}$ 的 t 值：

$$
t = \frac{\hat{\beta}}{\mathrm{SE}(\hat{\beta})}
$$

p 值同样来自 t 分布。

---

## 7. p 值实践注意事项（重要）

- p 值不能体现 **效果大小**（需要效应量 + 置信区间）
- p < 0.05 不代表结论“确定”
- 样本越大，越容易得到小 p 值
- 多重检验必须做校正（如 Bonferroni、FDR）
- p 值不能独立判断业务价值，需要结合实际场景

---

## 8. MATLAB 计算 p 值示例

### 单样本 t 检验

```matlab
data = [9 11 10 12 8];
mu0 = 10;

[h, p, ci, stats] = ttest(data, mu0);
disp(p)
```

### 双样本 t 检验

```matlab
A = [5 6 7 6];
B = [8 7 9 8];

[h, p, ci, stats] = ttest2(A, B);
disp(p)
```

### z 检验

```matlab
data = [51, 49, 52, 50, 50];
sigma = 10;
mu0 = 50;

[h, p, ci, zval] = ztest(data, mu0, sigma);
disp(p)
```

### 回归系数 p 值

```matlab
tbl = table(x, y);
mdl = fitlm(tbl, 'y ~ x');
mdl.Coefficients
```

---

## 9. 总结

- p 值描述的是“数据在原假设下有多罕见”
- 不是基于单一分布，而是基于统计量的理论分布
- 不应该单独依赖 p 值做决策
- 实际应用中应结合：效应量、置信区间、业务背景

