import{E as C,r as u,e as b,c as n,o as l,f as i,a as t,w as g,v as y,F as d,g as x,n as D,u as I,t as m}from"./app-5e-e_Qeg.js";import{_ as U}from"./plugin-vue_export-helper-DlAUqK2U.js";const j={class:"editor"},B=["disabled"],G={class:"editor-actions"},M={key:0,class:"comment-list"},V=["src"],z={class:"content"},E={class:"meta"},F={class:"author"},H={class:"time"},L={class:"text"},N={class:"actions"},S=["onClick"],T={__name:"Comment",setup($){const{isDarkMode:h}=C(),c=u([]),r=u(""),a=u(null),v=u("");async function _(){try{const e=await(await fetch("/api/comments.json")).json();c.value=e.filter(o=>o.postId===v.value)}catch(s){console.error("åŠ è½½è¯„è®ºå¤±è´¥",s)}}function p(){r.value.trim()&&(c.value.push({id:Date.now(),postId:v.value,author:a.value.username,avatar:a.value.avatar,content:r.value,likes:0,time:new Date().toLocaleString()}),r.value="")}function f(s){const e=c.value.find(o=>o.id===s);e&&e.likes++}function k(){console.log("1111s"),console.log(window.location.href),setTimeout(()=>{},2e4);const s=`http://localhost:8081/oauth2/authorization/github?redirect_uri=${encodeURIComponent(window.location.href)}`;window.open(s,"_blank")}async function w(){try{const e=await(await fetch("http://localhost:8081/api/auth/me",{credentials:"include"})).json();e.error?a.value=null:(console.log("2222"),a.value=e)}catch(s){console.error("è·å–ç”¨æˆ·å¤±è´¥",s),a.value=null}}return b(()=>{v.value=window.location.pathname,_(),w()}),(s,e)=>(l(),n(d,null,[i(" è¯„è®ºæ•´ä½“å®¹å™¨ "),t("div",{class:D(["comment-section",{dark:I(h)}])},[e[2]||(e[2]=t("h3",null,"è¯„è®º",-1)),i(" è¾“å…¥æ¡†åŒºåŸŸ "),t("div",j,[g(t("textarea",{"onUpdate:modelValue":e[0]||(e[0]=o=>r.value=o),class:"editor-input",placeholder:"ç™»å½•åå¯å‘è¡¨è¯„è®º...",disabled:!a.value},null,8,B),[[y,r.value]]),t("div",G,[i(" æœªç™»å½•æ—¶æ˜¾ç¤º GitHub ç™»å½•æŒ‰é’® "),a.value?(l(),n(d,{key:1},[i(" ç™»å½•åæ˜¾ç¤ºæäº¤æŒ‰é’® "),t("button",{class:"submit-btn",onClick:p}," æäº¤ ")],2112)):(l(),n("button",{key:0,class:"login-btn",onClick:k}," ä½¿ç”¨ GitHub ç™»å½• "))])]),i(" è¯„è®ºåˆ—è¡¨ "),c.value.length>0?(l(),n("div",M,[(l(!0),n(d,null,x(c.value,o=>(l(),n("div",{key:o.id,class:"comment-item"},[t("img",{src:o.avatar,alt:"avatar",class:"avatar"},null,8,V),t("div",z,[t("div",E,[t("span",F,m(o.author),1),t("span",H,m(o.time),1)]),t("p",L,m(o.content),1),t("div",N,[t("span",{class:"like",onClick:R=>f(o.id)},"ğŸ‘ "+m(o.likes),9,S)])])]))),128))])):(l(),n(d,{key:1},[i(" æ— è¯„è®ºæ—¶æç¤º "),e[1]||(e[1]=t("div",{class:"no-comment"},"æš‚æ— è¯„è®º",-1))],2112))],2)],2112))}},A=U(T,[["__scopeId","data-v-a8090235"]]);export{A as C};
